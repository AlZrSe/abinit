!{\src2tex{textfont=tt}}
!!****m* ABINIT/m_build_info
!! NAME
!!  m_build_info
!!
!! FUNCTION
!!  This module contains information about this particular version of ABINIT
!!  and its build parameters (useful for debugging).
!!
!! COPYRIGHT
!!  Copyright (C) 2005-2018 ABINIT group (Yann Pouillon, Matteo Giantomassi)
!!  This file is distributed under the terms of the
!!  GNU General Public License, see ~abinit/COPYING
!!  or http://www.gnu.org/copyleft/gpl.txt .
!!
!! SOURCE

#if defined HAVE_CONFIG_H
#include "config.h"
#endif

module m_build_info

  implicit none

! Try to prevent problems with the length of the argument 
! (should not exceed the line length of 132 character).
! So, always start the string to be replaced at the beginning of a line.

! Parameters set-up by Autoconf
  character(len=8),parameter :: abinit_version = &
&   "@VERSION@"
  character(len=*),parameter :: build_target = &
&   "@ABINIT_TARGET@"

! More info on current version
  character(len=*),parameter :: version_major = &
&   "@ABINIT_VERSION_MAJOR@"
  character(len=*),parameter :: version_minor = &
&   "@ABINIT_VERSION_MINOR@"
  character(len=*),parameter :: version_micro = &
&   "@ABINIT_VERSION_MICRO@"
  character(len=*),parameter :: version_build = &
&   "@ABINIT_VERSION_BUILD@"

! Info on compilers. Try to prevent problems with the length of the argument 
! (should not exceed the line length of 132 character).
  character(len=*),parameter :: cc_info = &
&   "@abi_cc_vendor@@abi_cc_version@"
  character(len=*),parameter :: cxx_info = &
&   "@abi_cxx_vendor@@abi_cxx_version@"
  character(len=*),parameter :: fc_info = &
&   "@abi_fc_vendor@@abi_fc_version@"
  character(len=*),parameter :: cc_flags = &
&   "@CFLAGS@"
  character(len=*),parameter :: cxx_flags = &
&   "@CXXFLAGS@"
  character(len=*),parameter :: fc_flags = &
&   "@FCFLAGS@"
  character(len=*),parameter :: fc_ldflags = &
&   "@FC_LDFLAGS@"

! Info on optimizations
  character(len=*),parameter :: debug_flavor = &
&   "@with_debug_flavor@"
  character(len=*),parameter :: optim_flavor = &
&   "@with_optim_flavor@"
  character(len=*),parameter :: cpu_info = &
&   "@abi_cpu_vendor@_@abi_cpu_model@"

! Info on openMP
  character(len=*),parameter :: enable_openmp = &
&   "@enable_openmp@"

! Info on MPI
  character(len=*),parameter :: enable_mpi = &
&   "@enable_mpi@"
  character(len=*),parameter :: enable_mpi_inplace = &
&   "@enable_mpi_inplace@"
  character(len=*),parameter :: enable_mpi_io = &
&   "@enable_mpi_io@"
  character(len=*),parameter :: enable_mpi_io_default = &
&   "@enable_mpi_io_default@"

! Info on GPU
  character(len=*),parameter :: enable_gpu = &
&   "@enable_gpu@"

! Info on High-Performance I/O
  character(len=*),parameter :: hpio_flavor = &
&   "@abi_hpio_flavor@"
  character(len=*),parameter :: enable_netcdf_default = &
&   "@enable_netcdf_default@"

! Info on linear algebra
  character(len=*),parameter :: linalg_flavor = &
&   "@abi_linalg_flavor@"

! Info on FFT
  character(len=*),parameter :: fft_flavor = &
&   "@abi_fft_flavor@"

! Info on time profiling
  character(len=*),parameter :: enable_papi = &
&   "@enable_papi@"
  character(len=*),parameter :: enable_timer = &
&   "@enable_timer@"

! Info on feature triggers
  character(len=*),parameter :: enable_avx_safe_mode = &
&   "@enable_avx_safe_mode@"
  character(len=*),parameter :: enable_bigdft = &
&   "@enable_bigdft@"
  character(len=*),parameter :: enable_bse_unpacked = &
&   "@enable_bse_unpacked@"
  character(len=*),parameter :: enable_cclock = &
&   "@enable_cclock@"
  character(len=*),parameter :: enable_clib = &
&   "@enable_clib@"
  character(len=*),parameter :: enable_expert = &
&   "@enable_expert@"
  character(len=*),parameter :: enable_fc_wrapper = &
&   "@enable_fc_wrapper@"
  character(len=*),parameter :: enable_fox = &
&   "@enable_fox@"
  character(len=*),parameter :: enable_gsl = &
&   "@enable_gsl@"
  character(len=*),parameter :: enable_gw_dpc = &
&   "@enable_gw_dpc@"
  character(len=*),parameter :: enable_levmar = &
&   "@enable_levmar@"
  character(len=*),parameter :: enable_libtetra = &
&   "@enable_libtetra@"
  character(len=*),parameter :: enable_lotf = &
&   "@enable_lotf@"
  character(len=*),parameter :: enable_memory_profiling = &
&   "@enable_memory_profiling@"
  character(len=*),parameter :: enable_psml = &
&   "@enable_psml@"
  character(len=*),parameter :: enable_triqs = &
&   "@enable_triqs@"
  character(len=*),parameter :: enable_wannier90 = &
&   "@enable_wannier90@"
  character(len=*),parameter :: enable_yaml = &
&   "@enable_yaml@"
  character(len=*),parameter :: enable_zdot_bugfix = &
&   "@enable_zdot_bugfix@"

contains  !===========================================================
!!***

!!****f* ABINIT/m_build_info/dump_config
!! NAME
!!  dump_config
!!
!! FUNCTION
!!  Reports a printout of the information stored in m_build_info,
!!  useful for error messages and debugging.
!!
!! INPUTS
!!  my_unit= Fortran unit number
!!
!! OUTPUT
!!  Only printing
!!
!! PARENTS
!!  Will be filled automatically by the parent script
!!
!! CHILDREN
!!  Will be filled automatically by the parent script
!!
!! SOURCE

subroutine dump_config(my_unit)

  implicit none

!Arguments ------------------------------------
  integer,intent(in) :: my_unit

!Local variables-------------------------------

! *********************************************************************
 
! TODO: things that might be added through preprocessing options, e.g.
! date and time of compilation 

  write(my_unit,*)
  write(my_unit,'(1x,a)') repeat('+',78)
  write(my_unit,*)
  write(my_unit,'(a)' )' === Build Information === '
  write(my_unit,'(2a)')'  Version       : ',trim(abinit_version)
  write(my_unit,'(2a)')'  Build target  : ',trim(build_target)
  write(my_unit,'(2a)')'  Build date    : ',trim(version_build)
  write(my_unit,*)
  write(my_unit,'(a)' )' === Compiler Suite === '
  write(my_unit,'(2a)')'  C compiler       : ',trim(cc_info)
  write(my_unit,'(2a)')'  C++ compiler     : ',trim(cxx_info)
  write(my_unit,'(2a)')'  Fortran compiler : ',trim(fc_info)
  write(my_unit,'(2a)')'  CFLAGS           : ',trim(cc_flags)
  write(my_unit,'(2a)')'  CXXFLAGS         : ',trim(cxx_flags)
  write(my_unit,'(2a)')'  FCFLAGS          : ',trim(fc_flags)
  write(my_unit,'(2a)')'  FC_LDFLAGS       : ',trim(fc_ldflags)
  write(my_unit,*)
  write(my_unit,'(a) ')' === Optimizations === '
  write(my_unit,'(2a)')'  Debug level        : ',trim(debug_flavor)
  write(my_unit,'(2a)')'  Optimization level : ',trim(optim_flavor)
  write(my_unit,'(2a)')'  Architecture       : ',trim(cpu_info)
  write(my_unit,*)
  write(my_unit,'(a) ')' === Multicore === '
  write(my_unit,'(2a)')'  OpenMP support  : ',trim(enable_openmp)
  write(my_unit,'(2a)')'  MPI support     : ',trim(enable_mpi)
  write(my_unit,'(2a)')'  MPI in place    : ',trim(enable_mpi_inplace)
  write(my_unit,'(2a)')'  MPI I/O         : ',trim(enable_mpi_io)
  write(my_unit,'(2a)')'  MPI I/O default : ',trim(enable_mpi_io_default)
  write(my_unit,'(2a)')'  GPU support     : ',trim(enable_gpu)
  write(my_unit,*)
  write(my_unit,'(a) ')' === Time profiling === '
  write(my_unit,'(2a)')'  PAPI timer   : ',trim(enable_papi)
  write(my_unit,'(2a)')'  Abinit timer : ',trim(enable_timer)
  write(my_unit,*)
  write(my_unit,'(a) ')' === High-Performance I/O === '
  write(my_unit,'(2a)')'  HPIO flavor   : ',trim(hpio_flavor)
  write(my_unit,*)
  write(my_unit,'(a) ')' === Linear algebra === '
  write(my_unit,'(2a)')'  LINALG flavor : ',trim(linalg_flavor)
  write(my_unit,*)
  write(my_unit,'(a) ')' === FFT === '
  write(my_unit,'(2a)')'  FFT flavor    : ',trim(fft_flavor)
  write(my_unit,*)
  write(my_unit,'(a) ')' === Feature triggers === '
  write(my_unit,'(2a)')'  Safe AVX            : ',trim(enable_avx_safe_mode)
  write(my_unit,'(2a)')'  BigDFT              : ',trim(enable_bigdft)
  write(my_unit,'(2a)')'  BSE unpacked        : ',trim(enable_bse_unpacked)
  write(my_unit,'(2a)')'  C clock             : ',trim(enable_cclock)
  write(my_unit,'(2a)')'  C library           : ',trim(enable_clib)
  write(my_unit,'(2a)')'  Expert mode         : ',trim(enable_expert)
  write(my_unit,'(2a)')'  Fortran wrapper     : ',trim(enable_fc_wrapper)
  write(my_unit,'(2a)')'  FoX                 : ',trim(enable_fox)
  write(my_unit,'(2a)')'  GSL                 : ',trim(enable_gsl)
  write(my_unit,'(2a)')'  GW double-precision : ',trim(enable_gw_dpc)
  write(my_unit,'(2a)')'  Levmar              : ',trim(enable_levmar)
  write(my_unit,'(2a)')'  Tetrahedron library : ',trim(enable_libtetra)
  write(my_unit,'(2a)')'  LOTF                : ',trim(enable_lotf)
  write(my_unit,'(2a)')'  Memory profiling    : ',trim(enable_memory_profiling)
  write(my_unit,'(2a)')'  PSML                : ',trim(enable_psml)
  write(my_unit,'(2a)')'  TRIQS               : ',trim(enable_triqs)
  write(my_unit,'(2a)')'  Wannier90           : ',trim(enable_wannier90)
  write(my_unit,'(2a)')'  YAML                : ',trim(enable_yaml)
  write(my_unit,'(2a)')'  ZDOT bugfix         : ',trim(enable_zdot_bugfix)
  write(my_unit,*)
  write(my_unit,'(1x,a)') repeat('+',78)
  write(my_unit,*)

end subroutine dump_config
!!***

end module m_build_info
!!***
