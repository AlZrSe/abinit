# LiH molecule. Use spatial chemical potential to orient the molecule.
#

ndtset 2

#Test the following chemical potential : in the relevant zone, the potential in linear,
# pulling the Li towards -z, and pushing the H towards +z.
chempot   -0.2 -0.01 0.05  #This is for the Li atom, defines the chemical potential at zred=-0.2
           0.2  0.01 0.05  #This is for the Li atom, defines the chemical potential at zred= 0.2

          -0.2  0.01 -0.05  #This is for the H atom, defines the chemical potential at zred=-0.2
           0.2 -0.01 -0.05  #This is for the H atom, defines the chemical potential at zred= 0.2

#For the first dataset, no chemical potential
nzchempot1 0

#For the second data set, turn on the chemical potential. Start with molecule aligned with z,
# the molecule is slightly stretched.
nzchempot2 2
xcart2   0.0 0.0  1.5
         0.0 0.0 -1.5

#Third data set, chemical potential present. Start with molecule not aligned with z.
xcart3  -1.5 0.0  0.1
         1.5 0.0 -0.1
#Fourth data set, chemical potential present. Start with molecule aligned with x, check that ABINIT
#takes into account the chemical potential in the determination of the spatial symmetry group.
xcart4  -1.5 0.0  0.0
         1.5 0.0  0.0
#Other data sets : should check differently varying chemical potentials.


# Common data
nband   2

acell  10 10 10

ecut      10.0 
pawecutdg 15.0 

natom     2
znucl     3 1  
ntypat    2
typat     1 2

ngkpt     1 1 1
xcart -1.5 0.0 0.0
       1.5 0.0 0.0

ionmov  2
ntime   5
tolmxf  5.d-5
tolrff  1.d-2

diemac    1.0    diemix 0.5d0
nstep 10

## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r
#%%<BEGIN TEST_INFO>
#%% [setup]
#%% executable = abinit
#%% [files]
#%% files_to_test = 
#%%   t30.out, tolnlines=    0,   tolabs=  0.0e+00,      tolrel= 0.0e+00, fld_options = -easy
#%% psp_files = Li.LDA-PW-paw.abinit, H.LDA-PW-paw.abinit
#%% [paral_info]
#%% max_nprocs = 1
#%% [extra_info]
#%% authors = X. Gonze 
#%% keywords = PAW
#%% description = 
#%%    LiH molecule
#%%    test the use of spatial chemical potential. The molecule starts aligned along the x direction,
#%%    while the Li chemical potential pulls the Li nucleus toward -z, and the H chemical potential 
#%%    pushes the H nucleus toward +z. See whether the optimization runs properly.
#%%<END TEST_INFO>
