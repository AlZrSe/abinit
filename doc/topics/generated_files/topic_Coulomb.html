<!--                                                                                     -->
<!-- This file has been produced by generate_doc.py using different .yml  or .bib files. -->
<!-- It is useless to modify it. Modify the related .yml  or .bib files instead.         -->
<!--                                                                                     -->
<html>
<head><title>Coulomb </title>
<link rel=stylesheet type="text/css" href="../../formabinit.css">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {inlineMath: [['$','$']]},
  displayAlign: "center",
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/javascript" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>
<body bgcolor="#ffffff">

<hr>
<a name="top"></a>

<h1>Coulomb interaction and charged cells</h1>
<h3>This page gives hints on how to treat adequately the Coulomb interaction, especially in charged cells, with the ABINIT package.
<hr>

<h5>Copyright (C) 2016-2017 ABINIT group (FB)
<script type="text/javascript" src="../../js_files/copyright.js"> </script>
</h5>

<script type="text/javascript" src="../../js_files/list_internal_links_for_generated_files.js"> </script>

 Mentioned in &nbsp; <a href="../../users/generated_files/help_features.html#2.2">help_features#2.2</a>. 
 <hr>
 <h3><b>Table of content: </b></h3> 
 <ul> <li>1. <a href="topic_Coulomb.html#1">Introduction.</a><li>2. <a href="topic_Coulomb.html#2">Related input variables.</a><li>3. <a href="topic_Coulomb.html#3">Selected input files.</a><li>4. <a href="topic_Coulomb.html#4">References.</a></ul>

&nbsp; 
<HR ALIGN=left> 
<a name="1">&nbsp;</a>
<h3><b>1. Introduction.</b></h3>


<p>ABINIT can treat charged systems (e.g. either for molecules, or for dopants in a supercell), 
using the <a href="../../variables/generated_files/varset_gstate.html#charge">charge</a> input variable. A careful convergence study with respect to the cell size must however be done.
<p>Depending on the dimension, different treatment of the Coulomb interaction can be enforced, 
governed by <a href="../../variables/generated_files/varset_gstate.html#icoulomb">icoulomb</a> for grouns-state calculations, 
and by <a href="../../variables/generated_files/varset_gw.html#icutcoul">icutcoul</a> for GW calculations. Some development effort is needed in ABINIT to rationalize the situation.

<p>Additional information concerning <a href="../../variables/generated_files/varset_paw.html#usepotzero">usepotzero</a>. It is well known that the electrostatic potential (arising from ion-ion, ion-electron, and electron-electron interactions) is ill-defined within periodic boundary conditions.
However, it is less well known that the total energy of a charged cell is also ill-defined.
In fact, after a careful derivation in <a href="../../biblio/generated_files/bib_biblio.html#Bruneval2014">[Bruneval2014]</a>, it was shown that the above two statements are tightly linked:
when the number of electrons differs from the number of protons in a cell, the necessary compensating background that enforces the overall charge neutrality
is sensitive to the arbitrary average electrostatic potential.

<p>ABINIT offers the possibility to choose which convention to use for the average electrostatic potential with the keyword <a href="../../variables/generated_files/varset_paw.html#usepotzero">usepotzero</a>.
<p>In PAW, one can choose among 3 options:
<li>the average of smooth electrostatic potential is set to zero;</li>
<li>the average of all-electron electrostatic potential is set to zero;</li>
<li>the average of smooth electrostatic potential is set to a finite value, which follows the Quantum Espresso implementation (see <a href="../../biblio/generated_files/bib_biblio.html#Giannozzi2009">[Giannozzi2009]</a> for more details).</li>

<p>Only options 1 and 3 are valid for the NCPP case.

<p>None of these conventions is intrinsically more correct than the other ones. This is just an arbitrary choice, but ABINIT now permits a straight comparison to the other codes.
<br><br><a href=#top>Go to the top</a>




&nbsp; 
<hr> 
<a name="2">&nbsp;</a>
<h3><b>2. Related input variables.</b></h3>


<p>Basic input variables:<p>... <a href="../../variables/generated_files/varset_gstate.html#charge">charge</a>   [CHARGE]<br>
<p>Useful input variables:<p>... <a href="../../variables/generated_files/varset_gstate.html#icoulomb">icoulomb</a>   [Index for the Coulomb TReaTMenT]<br>
... <a href="../../variables/generated_files/varset_gw.html#icutcoul">icutcoul</a>   [Integer that governs the CUT-off for COULomb interaction]<br>
... <a href="../../variables/generated_files/varset_paw.html#usepotzero">usepotzero</a>   [USE POTential ZERO]<br>
<p>Input variables for experts:<p>... <a href="../../variables/generated_files/varset_dev.html#nscforder">nscforder</a>   [Nth - SCaling Function ORDER]<br>

<br><br><a href=#top>Go to the top</a>


&nbsp; 
<HR ALIGN=left> 
<a name="3">&nbsp;</a>
<h3><b>3. Selected input files.</b></h3>


<i><b>WARNING</b> : as of ABINITv8.6.x, the list of input files provided in the specific section of the topics Web pages is still to be reviewed/tuned. In some cases, it will be adequate, and in other cases, it might be incomplete, or perhaps even useless.</i>
<br><br>The user can find some related example input files in the ABINIT package in the directory /tests, or on the Web:
<p> tests/v7/Input: <a href="../../tests/v7/Input/t26.in">t26.in</a> 
<br>

<br><br><a href=#top>Go to the top</a>


&nbsp; 
<HR ALIGN=left> 
<a name="4">&nbsp;</a>
<h3><b>4. References.</b></h3>


<br> <a href="../../biblio/generated_files/bib_biblio.html#Bruneval2014">[Bruneval2014]</a>  F. Bruneval, J.-P. Crocombette, X. Gonze, B. Dorado, M. Torrent and F. Jollet, "Consistent treatment of charged systems within periodic boundary conditions: The projector augmented-wave and pseudopotential methods revisited", Phys. Rev. B 89, 045116 (2014). <br> DOI: <a href="https://doi.org/10.1103/PhysRevB.89.045116">10.1103/PhysRevB.89.045116</a>.<br>
<br> <a href="../../biblio/generated_files/bib_biblio.html#Giannozzi2009">[Giannozzi2009]</a>  P. Giannozzi, S. Baroni, N. Bonini, M. Calandra, R. Car, C. Cavazzoni, D. Ceresoli, G.L. Chiarotti, M. Cococcioni, I. Dabo, A. Dal Corso, S. de Gironcoli, S. Fabris, G. Fratesi, R. Gebauer, U. Gerstmann, C. Gougoussis, A. Kokalj, M. Lazzeri, L. Martin-Samos, N. Marzari, F. Mauri, R. Mazzarello, S. Paolini, A. Pasquarello, L. Paulatto, C. Sbraccia, S. Scandolo, G. Sclauzero, A.P. Seitsonen, A. Smogunov, P. Umari and R.M. Wentzcovitch, "QUANTUM ESPRESSO: a modular and open-source software project for quantum simulations of materials", J. Phys.: Cond. Matt. 21, 395502 (2009). <br> URL: <a href="http://iopscience.iop.org/article/10.1088/0953-8984/21/39/395502"> http://iopscience.iop.org/article/10.1088/0953-8984/21/39/395502</a>.<br>
<p>
<br><br><a href=#top>Go to the top</a>

<script type="text/javascript" src="../../js_files/list_internal_links_for_generated_files.js"> </script>

</body>
</html>

